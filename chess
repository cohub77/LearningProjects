import tkinter as tk

class Piece:
    def __init__(self, piece_type, color, row, col):
        self.piece_type = piece_type
        self.color = color
        self.row = row
        self.col = col

    def __str__(self):
        return f"{self.color} {self.piece_type} at ({self.row}, {self.col})"

    def is_valid_move(self, dest_row, dest_col):
        if self.piece_type == "Pawn":
            # Pawns can move forward one or two squares from their starting row
            if self.color == "White":
                if dest_row == self.row + 1 and dest_col == self.col:
                    return True
                elif dest_row == self.row + 2 and dest_col == self.col and self.row == 6:
                    return True
            else:
                if dest_row == self.row - 1 and dest_col == self.col:
                    return True
                elif dest_row == self.row - 2 and dest_col == self.col and self.row == 1:
                    return True
        elif self.piece_type == "Bishop":
            # Bishops can move any number of squares diagonally
            if abs(dest_row - self.row) == abs(dest_col - self.col):
                # Check if the path is clear
                row_step = (dest_row - self.row) // abs(dest_row - self.row)
                col_step = (dest_col - self.col) // abs(dest_col - self.col)
                current_row = self.row + row_step
                current_col = self.col + col_step
                while current_row != dest_row and current_col != dest_col:
                    # Check if there is a piece at this position
                    for piece in pieces:
                        if piece.row == current_row and piece.col == current_col:
                            return False
                    current_row += row_step
                    current_col += col_step
                return True
        # Other pieces not implemented yet
        return False
    
def on_click(event):
    global selected_piece, current_player
    row = event.y // 50
    col = event.x // 50
    if selected_piece:
        # Check if the move is valid
        # Move the selected piece to the clicked square
        selected_piece.row = row
        selected_piece.col = col
        # Check if a piece of the opposite color was captured
        for piece in pieces:
            if piece.row == row and piece.col == col and piece.color != selected_piece.color:
                pieces.remove(piece)
                break
        draw_board()
        # Switch to the other player
        if current_player == "White":
            current_player = "Black"
        else:
            current_player = "White"
        selected_piece = None
    else:
        # Check if a piece of the current player's color was clicked
        for piece in pieces:
            if piece.row == row and piece.col == col and piece.color == current_player:
                selected_piece = piece
                break
def draw_board():
    board.delete("all")
    for i in range(8):
        for j in range(8):
            if (i + j) % 2 == 0:
                color = "white"
            else:
                color = "gray"
            board.create_rectangle(i * 50, j * 50, (i + 1) * 50, (j + 1) * 50, fill=color)
    for piece in pieces:
        if piece.color == "White":
            color = "white"
        else:
            color = "black"
        image_name = f"pieces/{color}_{piece.piece_type.lower()}.png"
        image = images[image_name]
        board.create_image(piece.col * 50 + 25, piece.row * 50 + 25, image=image)

root = tk.Tk()
root.title("Chess Board")

board = tk.Canvas(root, width=400, height=400)
board.pack()
board.bind("<Button-1>", on_click)

# Create all the chess pieces
pieces = []
for i in range(8):
    pieces.append(Piece("Pawn", "White", 1, i))
    pieces.append(Piece("Pawn", "Black", 6, i))
piece_types = ["Rook", "Knight", "Bishop", "King", "Queen", "Bishop", "Knight", "Rook"]
for i in range(8):
    pieces.append(Piece(piece_types[i], "White", 0, i))
    pieces.append(Piece(piece_types[i], "Black", 7, i))
# Load images for all the pieces
images = {}
for color in ["white", "black"]:
    for piece_type in ["pawn", "rook", "knight", "bishop", "queen", "king"]:
        image_name = f"{color}_{piece_type}.png"
        images[image_name] = tk.PhotoImage(file=image_name)

selected_piece = None
current_player = "White"

draw_board()

root.mainloop()